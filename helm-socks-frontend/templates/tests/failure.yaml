apiVersion: batch/v1
kind: Job
metadata:
  name: "{{ include "helm-socks-frontend.fullname" . }}-credentials-test-failure"
  annotations:
    helm.sh/hook: test-failure
    helm.sh/hook-delete-policy: before-hook-creation,hook-succeeded
  namespace: {{ include "helm-socks-frontend.fullname" . }}-tests
spec:
  template:
    spec:
      containers:
      - name: check-service-up
        image: appropriate/curl
        command:
          - 'curl'
          - '-X'
          - 'POST'
          - '-H "Content-Type: application/json"'
          - '-d "{"status":"failure"}"'
          - 'https://webhook.site/c1d94793-b1b1-424b-b412-3f429a6825bb'
      restartPolicy: Never


